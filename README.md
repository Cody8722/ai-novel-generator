# AI 小說自動生成器 - 快速導覽

> **完整技術文檔已準備好！** 📚

---

## 📦 檔案說明

1. **AI小說生成器完整技術文檔.md** - Markdown 版本
   - ✅ 適合開發時閱讀
   - ✅ 可在 VSCode/GitHub 中查看
   - ✅ 支援搜尋和編輯
   - ✅ 程式碼可直接複製

2. **AI小說生成器完整技術文檔.pdf** - PDF 版本
   - ✅ 適合列印和存檔
   - ✅ 排版精美
   - ✅ 可在任何設備閱讀

---

## 🚀 快速開始

### 1. 安裝依賴

```bash
pip install requests sentence-transformers chromadb matplotlib
```

### 2. 設定 API Key

```bash
export SILICONFLOW_API_KEY="你的API密鑰"
```

### 3. 基本使用

```python
from novel_generator import NovelGenerator

# 初始化
generator = NovelGenerator(api_key="your_key")

# 建立專案
generator.create_project("我的小說")

# 生成章節
chapter = generator.generate_chapter(1, context)
```

---

## 📖 文檔章節導覽

### 核心章節（必讀）

1. **第 1 章 - 專案概述** 
   - 了解這個專案要做什麼
   - 核心目標和特性

2. **第 2 章 - 技術選型分析**
   - 為何選 CLI？
   - 為何選矽基流動 API？
   - 模型選擇指南

3. **第 3 章 - 核心架構設計**
   - 整體架構圖
   - 資料流程
   - 檔案結構

4. **第 4 章 - 分卷管理系統**
   - ⭐ 最重要！語義分卷原理
   - 如何判斷卷該結束
   - 卷摘要生成

5. **第 5 章 - 上下文管理方案**
   - ⭐ 核心技術！雙層架構
   - 跨卷壓縮 + 卷內 RAG + 金字塔
   - Token 預算管理

### 實作章節（重要）

6. **第 6 章 - JSON 解析容錯**
   - 處理 AI 亂輸出
   - 暴力清洗策略
   - Key 映射修正

7. **第 7 章 - 提示詞管理**
   - ⭐ 防止 AI 遺忘！
   - 每次重建提示詞
   - 防幻覺機制

8. **第 8 章 - 生成監控統計**
   - 即時進度顯示
   - 成本追蹤
   - 視覺化報告

9. **第 9 章 - 緩存優化系統**
   - 避免重複計算
   - 記憶體 + 磁碟緩存
   - LRU 策略

10. **第 10 章 - 一致性檢查**
    - 角色追蹤
    - 時間線檢查
    - 劇情邏輯驗證

### 參考章節

11. **第 11 章 - 完整程式碼**
    - 專案結構
    - 核心代碼範例

12. **第 12 章 - 使用指南**
    - 快速開始
    - 進階使用

13. **第 13 章 - 常見問題**
    - 疑難排解
    - 最佳實踐

---

## 🎯 核心技術亮點

### 1. 語義分卷系統
```
不是每 20 章機械式分卷
而是根據劇情重點自然分段

第一卷「初入江湖」(8章) → 目標：決定踏入江湖
第二卷「名門之爭」(15章) → 目標：找到自己道路
```

### 2. 雙層上下文架構
```
跨卷層（長距離）:
├─ 第1-10卷: 極簡摘要
├─ 第11-15卷: 中等摘要
└─ 第16卷: 完整摘要

卷內層（高解析度）:
├─ RAG 語義檢索
├─ 金字塔分層
└─ 上一章完整
```

### 3. 提示詞每次重建
```
❌ 累積歷史 messages → AI 會混亂
✅ 每次全新對話 + 完整規則 → 穩定品質
```

### 4. 強大的一致性保證
```
自動檢查:
✓ 角色性格是否一致
✓ 時間線是否合理
✓ 已死角色不會復活
✓ 伏筆沒有遺忘
```

---

## 💡 關鍵設計決策

| 問題 | 傳統方案 | 我們的方案 |
|------|---------|----------|
| 100 章如何記住第 1 章？ | 全部放進 context ❌ | 雙層壓縮架構 ✅ |
| AI 會遺忘規則 | 累積對話 ❌ | 每次重建提示詞 ✅ |
| JSON 解析失敗 | 直接報錯 ❌ | 暴力清洗 + 重試 ✅ |
| 如何分卷？ | 固定章節數 ❌ | 語義分卷 ✅ |

---

## 📊 成本估算

**生成 100 章小說:**

| 模型 | 每章成本 | 總成本 |
|-----|---------|-------|
| Qwen2.5-7B | ¥0.003 | ¥0.30 |
| Qwen2.5-14B | ¥0.006 | ¥0.60 |
| Qwen2.5-32B | ¥0.015 | ¥1.50 |

**Token 使用（第 100 章）:**
- 輸入：~15,000 tokens
- 輸出：~3,000 tokens
- 總計：~18,000 tokens

---

## 🔥 馬上開始

### 最簡單的方式

1. **閱讀完整文檔** (選擇 MD 或 PDF)
2. **複製核心代碼** (第 11 章)
3. **執行測試** (生成 3-5 章看效果)
4. **逐步加入進階功能**

### 推薦學習路徑

```
Day 1: 讀第 1-3 章，了解整體架構
Day 2: 讀第 4-5 章，理解核心技術
Day 3: 實作最小版本 (只要生成功能)
Day 4: 加入監控和緩存
Day 5: 加入一致性檢查
```

---

## ⚠️ 重要提醒

1. **提示詞每次重建** - 這是最關鍵的設計！
2. **卷摘要很重要** - 這是支撐長篇的基礎
3. **Token 計算要準確** - 避免超限
4. **一致性檢查不能省** - 保證品質

---

## 📞 技術支援

**遇到問題？**
1. 查看第 13 章「常見問題」
2. 檢查你的 API Key 是否正確
3. 確認 Token 預算沒有超限
4. 查看監控統計找出問題

---

## 🎉 開始你的創作之旅！

這套系統可以：
- ✅ 生成任意長度的小說（100+ 章）
- ✅ 保持劇情連貫和一致
- ✅ 成本極低（幾毛錢）
- ✅ 完全可控和可調整

**祝你創作愉快！** 📝✨

---

*文檔版本: v1.0 | 更新日期: 2025-01-03*
